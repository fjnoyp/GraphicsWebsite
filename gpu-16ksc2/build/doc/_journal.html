<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>GPUProgramming: Development Journal</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GPUProgramming
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Development Journal </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#p">2014-10-06: modulo city and the bomb</a></li>
<li class="level1"><a href="#d">2014-10-05: finished rendering, on to the scene</a></li>
<li class="level1"><a href="#c">2014-10-04: tweaking the renderer and normals</a></li>
<li class="level1"><a href="#b">2014-10-02: trace-analytic and rendering</a></li>
<li class="level1"><a href="#a">2014-10-01: pixel grid and modulo</a></li>
</ul>
</div>
<div class="textblock"><p><em>Newest entries are at the top</em></p>
<h1><a class="anchor" id="p"></a>
2014-10-06: modulo city and the bomb</h1>
<p>I talked with you this morning and got insight on how I might move forward to make the program run faster. I removed all if statements at the cost of having the "random" building behavior that I had gotten before. I then switched to a separate random number generator that only created 1 or 0 to either disable or enable certain building extensions. Unfortunately, I get strange behavior at the "bounds" of different modulo sections:</p>
<p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='bad5.jpg'><img src='bad5.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> Issue with modulo</b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="bad5.jpg" alt="bad5.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>Unfortunately I was never able to resolve this issue. Instead, keeping in mind that my end goal was to have a city with plausible variation, I tried to get that same effect by having different modulo steps. The input point is moduloed by several different mod values. When that point is then used in different distance estimators, those objects all appear every mod by mod step in the world space. This process is explained in much more detail in the report.</p>
<p>Now that I was able to get different objects to appear at different positions in world space by using the mod operator I began to create different building objects. I created a set of generic building methods. These methods took in the p ray marcher position, a c local position, and a d dimensions specifier. These building methods would then create towers or office buildings or smokestacks.</p>
<p>I then had a set of other builder methods that used those generic building methods. These methods hard coded in the c and d inputs. They were then incorporated into the scene distance estimator.</p>
<div class="fragment"><div class="line"><span class="comment">//some builder methods:</span></div>
<div class="line"><span class="keywordtype">float</span> tower1(vec3 P){</div>
<div class="line">    <span class="keywordflow">return</span> et1(P, vec3(0,1.5,0), vec3(.5,2,.5)); </div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">float</span> tower2(vec3 P){</div>
<div class="line">    <span class="keywordflow">return</span> et2(P, vec3(0,1.5,0), vec3(1,2,1)); </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">//converts to a neater call for distance estimation:</span></div>
<div class="line"><span class="keywordflow">return</span> uOp( tower1(P), tower2(P) ); </div>
</div><!-- fragment --><p>Lastly, I made the getNormal equation actually return the proper normal value. Before it was evaluating a box distance estimator for normals which resulted in poor visual quality. Unfortunately, adding in the proper normal equation (ie. evaluating the actual distance estimator function) made each shader reload take on average 3 minutes to load.</p>
<p>I really really really wanted to incorporate what I had made before with the exploding color ball. That desire made me wonder what sMin might look like if expanded over the city. I added in a sphere and sMinned it with the city. The result was really cool and looked a lot like a nuclear explosion.</p>
<p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='OldBoom.jpg'><img src='OldBoom.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> "The original explosion"</b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="OldBoom.jpg" alt="OldBoom.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>At this point I had to make a stylistic choice between the cartoony look of having non reflective surfaces on the city and the alternate look of having a reflective city. I was leaning towards the cartoony look but didn't like how poorly defined the city was as a result. I asked some of the people in lab and they recommended that I go with the reflective look.</p>
<p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='NewBoom.jpg'><img src='NewBoom.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> "The new explosion"</b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="NewBoom.jpg" alt="NewBoom.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>At this point I began to make the movie. As mentioned in the report I started with the basic idea that there should be a progression from city to nuclear shots. That idea motivated the shots I took. With the music I got from Devon's help I stitched and cut the shots in iMovie. For more details see the report.</p>
<p>I was able to incorporate the color ball exploding thing I created for the credit! :)</p>
<h1><a class="anchor" id="d"></a>
2014-10-05: finished rendering, on to the scene</h1>
<p>Realized that my epsilon value was too high and reduced it. I now get long view distances and my short view distance no longer has the weird behavior shown below:</p>
<p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='bad4.jpg'><img src='bad4.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> This happens when all the constants are right except for epsilon when calculating surface normals </b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="bad4.jpg" alt="bad4.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>I then moved on to the final scene. I was curious with twists and got some interesting results like below:</p>
<p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='twist1.mp4'><div style='border: 1px solid #00F; width: 180px; height: 120px; background: #222; color: #AAA; text-align: center;'><span style='position: relative; top: 40px; font-size: 100px; '>&#9654;</span><br></br><span style='position: relative; top: 30px;'>Play Video</span></div></a></td></tr><tr><td align='center'><b> Twisty</b></td></table> </p><div style="display: none; visibility:hidden"> <div class="image">
<img src="twist1.mp4" alt="twist1.mp4"/>
</div>
 </div><p>I also tried relating the mod function to the ray's P position and got some really cool behavior when I added an additional time variable and related P position to color:</p>
<p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='blackColor1.mp4'><div style='border: 1px solid #00F; width: 180px; height: 120px; background: #222; color: #AAA; text-align: center;'><span style='position: relative; top: 40px; font-size: 100px; '>&#9654;</span><br></br><span style='position: relative; top: 30px;'>Play Video</span></div></a></td></tr><tr><td align='center'><b> :) </b></td></table> </p><div style="display: none; visibility:hidden"> <div class="image">
<img src="blackColor1.mp4" alt="blackColor1.mp4"/>
</div>
 </div><p>  <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='blackColor2.mp4'><div style='border: 1px solid #00F; width: 180px; height: 120px; background: #222; color: #AAA; text-align: center;'><span style='position: relative; top: 40px; font-size: 100px; '>&#9654;</span><br></br><span style='position: relative; top: 30px;'>Play Video</span></div></a></td></tr><tr><td align='center'><b> :) </b></td></table> </p><div style="display: none; visibility:hidden"> <div class="image">
<img src="blackColor2.mp4" alt="blackColor2.mp4"/>
</div>
 </div><p>  <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='whiteColor1.mp4'><div style='border: 1px solid #00F; width: 180px; height: 120px; background: #222; color: #AAA; text-align: center;'><span style='position: relative; top: 40px; font-size: 100px; '>&#9654;</span><br></br><span style='position: relative; top: 30px;'>Play Video</span></div></a></td></tr><tr><td align='center'><b> :) </b></td></table> </p><div style="display: none; visibility:hidden"> <div class="image">
<img src="whiteColor1.mp4" alt="whiteColor1.mp4"/>
</div>
 </div><p>  <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='whiteColor2.mp4'><div style='border: 1px solid #00F; width: 180px; height: 120px; background: #222; color: #AAA; text-align: center;'><span style='position: relative; top: 40px; font-size: 100px; '>&#9654;</span><br></br><span style='position: relative; top: 30px;'>Play Video</span></div></a></td></tr><tr><td align='center'><b> :) </b></td></table> </p><div style="display: none; visibility:hidden"> <div class="image">
<img src="whiteColor2.mp4" alt="whiteColor2.mp4"/>
</div>
 </div><p> <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='blackColorImage1.jpg'><img src='blackColorImage1.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> :) </b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="blackColorImage1.jpg" alt="blackColorImage1.jpg"/>
</div>
<p>  <script>document.write('</div>');</script>   <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='blackColorImage2.jpg'><img src='blackColorImage2.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> :) </b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="blackColorImage2.jpg" alt="blackColorImage2.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>These were all by chance so I focused on making a physical object. I wanted to make a repeating city with modulo, but to have the city have variation. I had a lot of difficulty just trying to get certain objects to appear every n steps and another object to appear every k steps, I tried doing modulo on the actual P value given to the distance estimator but that resulted in strange behavior. In the end, I switched to rudimentary binning, where I divided the entire world space into 15x15 bins. Then every third or second bin I would do something special. This behavior worked and I extended it to tree expansions, whereby a given box created in a certain bin could extend out to different objects like a chimney or a roof. For example, I would have a function eb1 that evaluated to a box. This function would take in the ray's position but would also take in a c value for its position (relative to modulo offsets) and a d value that woudl specify its height and width properties. It then ran an if statement based on a random math function. If the math function's return value was greater than 0.5 it would evalute a box function but also evalute a chimney function as well, else it would not generate anything at all. The idea here was that different boxes would have chimneys or windows, etc. and by having a d value that was passed to each function, I could change the size of the buildings. By having a sort of pseudo tree expansion behavior for the building, I was hoping to have a huge variety of buildings. The random function was a function of world position. Unfortunately this all used a lot of if statements which resulted in very very slow performance. This approach was probably most suited for non GPU programs. Perhaps this approach can be reused for the midterm.</p>
<h1><a class="anchor" id="c"></a>
2014-10-04: tweaking the renderer and normals</h1>
<p>Began to adapt my implicit surface renderer to have proper materials. I thought that we had to calculate normals manually per shape before realizing that you had posted the equation online. Unfortunately, the equation had errors so we had to readapt it to make it work. Matt was able to get his version working and he shared the corrected equation with us so that we could move forward. At the end of this period I had a working renderer. I also spent a large amount of time trying to weak the values of epsilon, closeEnough, and the distance estimator to get proper behavior on materials. Below, some screenshots of the weird behavior I saw.</p>
<p>When the sceneDistance is not divided by two weird behavior results.  <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='bad1.jpg'><img src='bad1.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> view right - weird behavior</b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="bad1.jpg" alt="bad1.jpg"/>
</div>
<p>  <script>document.write('</div>');</script>   <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='bad2.jpg'><img src='bad2.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> view left - more weird behavior</b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="bad2.jpg" alt="bad2.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>When you divide scene distance by 2 and decrease closeEnough, behavior is better, but zooming out results in clear limits to view distance.  <table style='display:inline-table;' cellspacing='2' cellpadding='0' border='0'><tr><td align='center'><a href='bad3.jpg'><img src='bad3.jpg' border='1' height='120'></img></a></td></tr><tr><td align='center'><b> :( </b></td></table> <script>document.write('<div style=\'display: none; visibility: hidden;\'>');</script>  </p><div class="image">
<img src="bad3.jpg" alt="bad3.jpg"/>
</div>
<p>  <script>document.write('</div>');</script> </p>
<p>Lastly, I decided to change the structure of my code. Intead of using separate instances to structs to render each object on the screen, I switched to having all of the objects being rendered from a single interesect method.</p>
<h1><a class="anchor" id="b"></a>
2014-10-02: trace-analytic and rendering</h1>
<p>Learned that trace-analytic contains almost all of the code needed for the rendering portion of this lab. I tried to adapt it by copying over methods, unfortunately I still didn't really know what was going on so I was wasting more time than I should have. In the end I was getting partial behavior so I restarted took another look at the code and realized that I only needed to change the intersect method called from the sphere.glsl file to get the behavior that I wanted. I copied the trace-analystic and redid the sphere.glsl intersect method. Unfortunately, the constants, closeEnough, and the distance estimator were off resulting in strange image behavior such as clipping and point cloud objects.</p>
<h1><a class="anchor" id="a"></a>
2014-10-01: pixel grid and modulo</h1>
<p>Completed the pixel grid portion of the pre lab. Implemented the modulo operator on the sphere distance estimator I had created. Did all of this in a separate .pix file.</p>
<p>My code:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(  mod(gl_FragCoord.x,32) &lt; 16 &amp;&amp; mod(gl_FragCoord.y,32) &gt; 16){</div>
<div class="line">    pixelColor = Radiance3(0,0,0); </div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span>(  mod(gl_FragCoord.x,32) &gt; 16 &amp;&amp; mod(gl_FragCoord.y,32) &lt; 16){</div>
<div class="line">    pixelColor = Radiance3(0,0,0); </div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span>{</div>
<div class="line">    pixelColor = Radiance3(1,1,1); </div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 10 2014 18:12:46 for GPUProgramming by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
